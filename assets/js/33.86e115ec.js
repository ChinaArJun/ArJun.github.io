(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1043:function(t,a,s){"use strict";s.r(a);var n=s(44),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"day08课上笔记"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#day08课上笔记"}},[t._v("#")]),t._v(" day08课上笔记")]),t._v(" "),n("h1",{attrs:{id:"内容回顾"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#内容回顾"}},[t._v("#")]),t._v(" 内容回顾")]),t._v(" "),n("h2",{attrs:{id:"并发之goroutine"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#并发之goroutine"}},[t._v("#")]),t._v(" 并发之goroutine")]),t._v(" "),n("h3",{attrs:{id:"并发和并行的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#并发和并行的区别"}},[t._v("#")]),t._v(" 并发和并行的区别")]),t._v(" "),n("h3",{attrs:{id:"goroutine的启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#goroutine的启动"}},[t._v("#")]),t._v(" goroutine的启动")]),t._v(" "),n("p",[t._v("将要并发执行的任务包装成一个函数，调用函数的时候前面加上"),n("code",[t._v("go")]),t._v("关键字，就能够开启一个goroutine去执行该函数的任务。")]),t._v(" "),n("p",[t._v("goroutine对应的函数执行完，该goroutine就结束了。")]),t._v(" "),n("p",[t._v("程序启动的时候会自动的创建一个goroutine去执行main函数")]),t._v(" "),n("p",[t._v("main函数结束了，那么程序就结束了，由该程序启动的所有其他goroutine也都结束了。")]),t._v(" "),n("h3",{attrs:{id:"goroutine的本质"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#goroutine的本质"}},[t._v("#")]),t._v(" goroutine的本质")]),t._v(" "),n("p",[t._v("goroutine的调度模型："),n("code",[t._v("GMP")])]),t._v(" "),n("p",[n("code",[t._v("M:N")]),t._v("：把m个goroutine分配给n个操作系统线程。")]),t._v(" "),n("h3",{attrs:{id:"goroutine与操作系统线程（os线程）的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#goroutine与操作系统线程（os线程）的区别"}},[t._v("#")]),t._v(" goroutine与操作系统线程（OS线程）的区别")]),t._v(" "),n("p",[t._v("goroutine是用户态的线程，比内核态的线程更轻量级一点，初始时只占用2KB的栈空间。")]),t._v(" "),n("p",[t._v("可以轻松开启数十万的goroutine也不会崩内存。")]),t._v(" "),n("h3",{attrs:{id:"runtime-gomaxprocs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#runtime-gomaxprocs"}},[t._v("#")]),t._v(" runtime.GOMAXPROCS")]),t._v(" "),n("p",[t._v("Go1.5之后默认就是操作系统的逻辑核心数，默认跑满CPU")]),t._v(" "),n("p",[n("code",[t._v("runtime.GOMAXPROCS(1)")]),t._v(":只占用一个核。")]),t._v(" "),n("h3",{attrs:{id:"work-pool模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#work-pool模式"}},[t._v("#")]),t._v(" work pool模式")]),t._v(" "),n("p",[t._v("开启一定数据的goroutine去干活。")]),t._v(" "),n("h3",{attrs:{id:"sync-waitgroup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sync-waitgroup"}},[t._v("#")]),t._v(" sync.WaitGroup")]),t._v(" "),n("p",[n("code",[t._v("var wg sync.WaitGroup")])]),t._v(" "),n("ul",[n("li",[t._v("wg.Add(1)  ：计数器+1")]),t._v(" "),n("li",[t._v("wg.Done()：计数器-1")]),t._v(" "),n("li",[t._v("wg.Wait()：等")])]),t._v(" "),n("h2",{attrs:{id:"channel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#channel"}},[t._v("#")]),t._v(" channel")]),t._v(" "),n("h3",{attrs:{id:"为什么需要channel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要channel"}},[t._v("#")]),t._v(" 为什么需要channel?")]),t._v(" "),n("p",[t._v("通过channel实现多个goroutine之间的通信。")]),t._v(" "),n("p",[n("code",[t._v("CSP")]),t._v(":通过通信来共享内存。")]),t._v(" "),n("p",[t._v("channel是一种类型，一种引用类型。make函数初始化之后才能使用。（slice、map、channel）")]),t._v(" "),n("h3",{attrs:{id:"channel的声明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#channel的声明"}},[t._v("#")]),t._v(" channel的声明")]),t._v(" "),n("p",[n("code",[t._v("var ch chan 元素类型")])]),t._v(" "),n("h3",{attrs:{id:"channel的初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#channel的初始化"}},[t._v("#")]),t._v(" channel的初始化")]),t._v(" "),n("p",[n("code",[t._v("ch = make(chan 元素类型, [缓冲区大小])")])]),t._v(" "),n("h3",{attrs:{id:"channel的操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#channel的操作"}},[t._v("#")]),t._v(" channel的操作")]),t._v(" "),n("ul",[n("li",[t._v("发送："),n("code",[t._v("ch <- 100")])]),t._v(" "),n("li",[t._v("接收："),n("code",[t._v("x := <- ch")])]),t._v(" "),n("li",[t._v("关闭: "),n("code",[t._v("close(ch)")])])]),t._v(" "),n("h3",{attrs:{id:"带缓冲区的通道和无缓冲区的通道："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#带缓冲区的通道和无缓冲区的通道："}},[t._v("#")]),t._v(" 带缓冲区的通道和无缓冲区的通道：")]),t._v(" "),n("p",[t._v("快递员送快递的示例，有缓冲区就是有快递柜。")]),t._v(" "),n("h3",{attrs:{id:"从通道中取值："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从通道中取值："}},[t._v("#")]),t._v(" 从通道中取值：")]),t._v(" "),n("div",{staticClass:"language-go extra-class"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ok "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<-")]),t._v("results\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("ok "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 什么时候ok=false? results被关闭的时候")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\tfmt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" x "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("range")]),t._v(" results "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tfmt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"单项通道："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单项通道："}},[t._v("#")]),t._v(" 单项通道：")]),t._v(" "),n("p",[t._v("通常是用做函数的参数，只读通道"),n("code",[t._v("<-chan int")]),t._v("和只写通道"),n("code",[t._v("chan<- int")])]),t._v(" "),n("h3",{attrs:{id:"通道的各种考虑情况："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通道的各种考虑情况："}},[t._v("#")]),t._v(" 通道的各种考虑情况：")]),t._v(" "),n("p",[n("img",{attrs:{src:s(533),alt:"1566009364187"}})]),t._v(" "),n("h2",{attrs:{id:"select"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#select"}},[t._v("#")]),t._v(" select")]),t._v(" "),n("p",[t._v("同一时刻有多个通道要操作的场景下，使用select。")]),t._v(" "),n("p",[n("img",{attrs:{src:s(534),alt:"1566009690819"}})]),t._v(" "),n("h1",{attrs:{id:"今日内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#今日内容"}},[t._v("#")]),t._v(" 今日内容")]),t._v(" "),n("h2",{attrs:{id:"sync包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sync包"}},[t._v("#")]),t._v(" sync包")]),t._v(" "),n("h3",{attrs:{id:"sync-mutex-互斥锁"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sync-mutex-互斥锁"}},[t._v("#")]),t._v(" sync.Mutex 互斥锁")]),t._v(" "),n("p",[t._v("适用于并发访问公共资源的场景。")]),t._v(" "),n("p",[t._v("声明互斥锁")]),t._v(" "),n("div",{staticClass:"language-go extra-class"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" lock sync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mutex\n")])])]),n("p",[t._v("使用互斥锁")]),t._v(" "),n("div",{staticClass:"language-go extra-class"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("500000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tlock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Lock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" x "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\t\tlock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\twg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Done")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"sync-rwmutex-读写互斥锁"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sync-rwmutex-读写互斥锁"}},[t._v("#")]),t._v(" sync.RWMutex 读写互斥锁")]),t._v(" "),n("p",[t._v("适用于读远远大于写的场景。")]),t._v(" "),n("p",[t._v("声明读写互斥锁")]),t._v(" "),n("div",{staticClass:"language-go extra-class"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" rwLock sync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RWMutex\n")])])]),n("p",[t._v("使用读写互斥锁")]),t._v(" "),n("div",{staticClass:"language-go extra-class"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 读操作")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defer")]),t._v(" wg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Done")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\trwLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("RLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tfmt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ttime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Millisecond "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\trwLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("RUnlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 写操作")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defer")]),t._v(" wg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Done")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\trwLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Lock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" x "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\ttime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Millisecond "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\trwLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"sync-once"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sync-once"}},[t._v("#")]),t._v(" sync.Once")]),t._v(" "),n("p",[t._v("适用于那些只执行一次的场景。")]),t._v(" "),n("p",[t._v("例如，只加载一次图片、只关闭一次channel")]),t._v(" "),n("h3",{attrs:{id:"sync-map"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sync-map"}},[t._v("#")]),t._v(" sync.Map")]),t._v(" "),n("p",[t._v("Go内置的map不是并发安全的。")]),t._v(" "),n("div",{staticClass:"language-go extra-class"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sync.Map 是一个开箱即用的并发安全的map")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" m2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Map"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\twg "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" sync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WaitGroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\twg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tkey "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" strconv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Itoa")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\tm2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Store")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必须使用sync.Map内置的Store方法设置键值对")]),t._v("\n\t\t\tvalue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" m2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Load")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必须使用sync.Map提供的Load方法根据key取值")]),t._v("\n\t\t\tfmt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"k=:%v,v:=%v\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\twg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Done")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\twg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Wait")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"atomic"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#atomic"}},[t._v("#")]),t._v(" atomic")]),t._v(" "),n("h3",{attrs:{id:"网络编程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络编程"}},[t._v("#")]),t._v(" 网络编程")]),t._v(" "),n("h3",{attrs:{id:"互联网协议"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#互联网协议"}},[t._v("#")]),t._v(" 互联网协议")]),t._v(" "),n("h3",{attrs:{id:"tcp客户端和服务端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp客户端和服务端"}},[t._v("#")]),t._v(" TCP客户端和服务端")]),t._v(" "),n("h3",{attrs:{id:"tcp黏包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp黏包"}},[t._v("#")]),t._v(" TCP黏包")]),t._v(" "),n("h3",{attrs:{id:"udp客户端和服务端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#udp客户端和服务端"}},[t._v("#")]),t._v(" UDP客户端和服务端")]),t._v(" "),n("p",[t._v("引申知识点:")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/36149865",target:"_blank",rel:"noopener noreferrer"}},[t._v("大端和小端"),n("OutboundLink")],1)]),t._v(" "),n("h1",{attrs:{id:"作业"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#作业"}},[t._v("#")]),t._v(" 作业")]),t._v(" "),n("ol",[n("li",[t._v("写一个支持多客户端聊天的人工智能TCP的服务\n"),n("ol",[n("li",[t._v("把?换成!")]),t._v(" "),n("li",[t._v("把你换成我")]),t._v(" "),n("li",[t._v("把吗去掉")])])])]),t._v(" "),n("p",[t._v("问:你是机器人吗?")]),t._v(" "),n("p",[t._v("回:我是机器人")])])}),[],!1,null,null,null);a.default=r.exports},533:function(t,a,s){t.exports=s.p+"assets/img/1566009364187.e9471d66.png"},534:function(t,a,s){t.exports=s.p+"assets/img/1566009690819.d5e257b4.png"}}]);